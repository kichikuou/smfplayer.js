/** @license smfplayer.js 2013 - imaya / GREE Inc. [ https://github.com/gree/smfplayer.js ] The MIT License */(function() {'use strict';var i=null,l=this;function p(f,b){var c=f.split("."),d=l;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var a;c.length&&(a=c.shift());)!c.length&&void 0!==b?d[a]=b:d=d[a]?d[a]:d[a]={}}function q(f){var b=r;function c(){}c.prototype=b.prototype;f.o=b.prototype;f.prototype=new c};function r(f,b,c){this.f=f;this.m=b;this.time=c}function s(f,b,c,d,a,g){r.call(this,f,b,c);this.h=d;this.j=a;this.e=g}q(s);function t(f,b,c,d){r.call(this,f,b,c);this.data=d}q(t);function x(f,b,c,d){r.call(this,f,b,c);this.data=d}q(x);function y(f,b){b=b||{};this.input=f;this.a=b.index||0;this.length=b.length||f.length-this.a;this.offset=this.a;this.padding=void 0!==b.padding?b.padding:!0;this.g=void 0!==b.bigEndian?b.bigEndian:!1}
y.prototype.parse=function(){var f=this.length+this.offset;for(this.d=[];this.a<f;){var b=this.input,c=this.a,d=void 0;this.d.push({type:String.fromCharCode(b[c++],b[c++],b[c++],b[c++]),size:d=this.g?(b[c++]<<24|b[c++]<<16|b[c++]<<8|b[c++])>>>0:(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,offset:c});c+=d;this.padding&&1===(c-this.offset&1)&&c++;this.a=c}};function z(f,b){var c=f.d[b];return void 0===c?i:c};function A(f,b){b=b||{};b.padding=!1;b.bigEndian=!0;this.input=f;this.a=b.index||0;this.c=0;this.b=new y(f,b);this.l=[];this.k=[]}A.prototype.parse=function(){var f,b;this.b.parse();f=z(this.b,this.c++);b=this.input;var c=f.offset;if(!f||"MThd"!==f.type)throw Error("invalid header signature");this.n=b[c++]<<8|b[c++];this.i=b[c++]<<8|b[c++];this.p=b[c++]<<8|b[c++];f=0;for(b=this.i;f<b;++f)D(this)};
function D(f){function b(){var b=0,c;do c=d[a++],b=b<<7|c&127;while(0!==(c&128));return b}var c=z(f.b,f.c++),d=f.input,a=c.offset,g,j,m,u=-1,v=-1,e,h=0,k,n;if(!c||"MTrk"!==c.type)throw Error("invalid header signature");for(var c=c.offset+c.size,B=[],C=[];a<c;){g=b();h+=g;k=a;n=d[a++];j=n>>4&15;m=n&15;8>j?(j=u,m=v,n=u<<4|v,a--,k--):(u=j,v=m);var w=[,,,,,,,,"NoteOff","NoteOn","NoteAftertouch","ControlChange","ProgramChange","ChannelAftertouch","PitchBend"];switch(j){case 8:case 9:case 10:case 11:case 13:case 14:e=
new s(w[j],g,h,m,d[a++],d[a++]);break;case 12:e=new s(w[j],g,h,m,d[a++]);break;case 15:switch(m){case 0:e=b();if(247!==d[a+e-1])throw Error("invalid SysEx event");e=new t("SystemExclusive",g,h,d.subarray(a,(a+=e)-1));break;case 7:e=b();e=new t("SystemExclusive(F7)",g,h,d.subarray(a,a+=e));break;case 15:j=d[a++];e=b();switch(j){case 0:e=new x("SequenceNumber",g,h,[d[a++],d[a++]]);break;case 1:e=new x("TextEvent",g,h,[String.fromCharCode.apply(i,d.subarray(a,a+=e))]);break;case 2:e=new x("CopyrightNotice",
g,h,[String.fromCharCode.apply(i,d.subarray(a,a+=e))]);break;case 3:e=new x("SequenceTrackName",g,h,[String.fromCharCode.apply(i,d.subarray(a,a+=e))]);break;case 4:e=new x("InstrumentName",g,h,[String.fromCharCode.apply(i,d.subarray(a,a+=e))]);break;case 5:e=new x("Lyrics",g,h,[String.fromCharCode.apply(i,d.subarray(a,a+=e))]);break;case 6:e=new x("Marker",g,h,[String.fromCharCode.apply(i,d.subarray(a,a+=e))]);break;case 7:e=new x("CuePoint",g,h,[String.fromCharCode.apply(i,d.subarray(a,a+=e))]);
break;case 32:e=new x("MidiChannelPrefix",g,h,[d[a++]]);break;case 47:e=new x("EndOfTrack",g,h,[]);break;case 81:e=new x("SetTempo",g,h,[d[a++]<<16|d[a++]<<8|d[a++]]);break;case 84:e=new x("SmpteOffset",g,h,[d[a++],d[a++],d[a++],d[a++],d[a++]]);break;case 88:e=new x("TimeSignature",g,h,[d[a++],d[a++],d[a++],d[a++]]);break;case 89:e=new x("KeySignature",g,h,[d[a++],d[a++]]);break;case 127:e=new x("SequencerSpecific",g,h,[d.subarray(a,a+=e)]);break;default:e=new x("Unknown",g,h,[j,d.subarray(a,a+=e)])}break;
default:l.console.log("unknown message:",n.toString(16))}break;default:throw Error("invalid status");}g=a-k;k=d.subarray(k,k+g);k[0]=n;e instanceof s&&("NoteOn"===e.f&&0===e.e)&&(e.f=w[8],k=new Uint8Array([128|e.h,e.j,e.e]));C.push(k);B.push(e)}f.l.push(B);f.k.push(C)};p("SMF.Parser",A);p("SMF.Parser.prototype.parse",A.prototype.parse);}).call(this); //@ sourceMappingURL=smf.parser.min.js.map
